$.fn.inlineSlider=function(e){return this.each(function(){var t={init:function(e,t){var n={width:200,inputWidth:40,min:0,max:1e3,step:1,onChange:null,onMove:null,onDragStart:null,onDragEnd:null,onScrollStart:null,onScrollEnd:null};this.options=$.extend(n,t);this.$input=$(e);var r=$('<div class="inlineSlider"><div class="slider" /></div>');this.$input.wrap(r);this.$input.before('<div class="arrow arrow-left" />');this.$input.after('<div class="arrow arrow-right" />');this.$slider=this.$input.parent(".slider");this.$slider.wrap('<div class="container" />');this.$track=$('<div class="track"><div class="line" /></div>');this.$slider.before(this.$track);this.$input.css("width",this.options.inputWidth+"px");this.$track.css("width",this.options.width+"px");var i=this.$input.attr("data-min");if(i)this.options.min=parseFloat(i);var s=this.$input.attr("data-max");if(s)this.options.max=parseFloat(s);var o=this.$input.attr("data-step");if(o)this.options.step=parseFloat(o);this.registerEvents();this.jumpToCurrentValue()},registerEvents:function(){var e=this;this.$input.bind("change",function(){e.jumpToCurrentValue();e.trigger("onChange")});this.$slider.find(".arrow").bind("mousedown",function(t){t.preventDefault();e.startDragging(t)});this.$track.bind("mousedown",function(t){t.preventDefault();e.startScrolling(t)})},startDragging:function(e){var t=this;this.offset=[e.pageX,e.pageY];this.pos=this.$slider.position();this.trigger("onDragStart");$(document).bind("mouseup.inlineSlider",function(e){t.stopDragging.call(t,e)});$(document).bind("mousemove.inlineSlider",function(e){t.calculateDragDelta.call(t,e)});this.$input.focus()},stopDragging:function(){$(document).unbind("mouseup.inlineSlider mousemove.inlineSlider");this.offset=null;this.pos=null;this.trigger("onDragEnd");this.trigger("onChange")},calculateDragDelta:function(e){if(this.offset){var t=e.pageX-this.offset[0];var n=this.pos.left+t;this.setPosition(n)}},startScrolling:function(e){var t=this;this.scrollTo=[e.pageX,e.pageY];this.trigger("onScrollStart");$(document).bind("mouseup.inlineSlider",function(e){t.stopScrolling.call(t,e)});$(document).bind("mousemove.inlineSlider",function(e){t.scrollTo=[e.pageX,e.pageY]});this.scroll()},stopScrolling:function(){$(document).unbind("mouseup.inlineSlider mousemove.inlineSlider");this.scrollTo=null;clearTimeout(this.scrollTimeout);this.trigger("onScrollEnd");this.trigger("onChange")},scroll:function(){if(this.scrollTo){var e=this;var t=this.$slider.offset();var n=this.$slider.position();var r=this.$track.width()/10;var i=this.scrollTo[0]-t.left-this.$slider.outerWidth()/2;var s=i<0?Math.max(i,r*-1):Math.min(i,r);this.setPosition(n.left+s);this.scrollTimeout=setTimeout(function(){e.scroll()},150)}},jumpToCurrentValue:function(){var e=this.parseValue(this.$input.val());var t=this.calculatePosition(e);this.moveSliderTo(t);this.$input.val(e)},parseValue:function(e){e=parseFloat(e);if(e<=this.options.min){e=this.options.min}if(e>=this.options.max){e=this.options.max}if(this.options.step){var t=e%this.options.step;e=e-t}return e},getValue:function(){return parseFloat(this.$input.val())},updateInputValue:function(e){e=this.parseValue(e);var t=this.getValue();if(t!==e){this.$input.val(e);this.trigger("onMove")}},trigger:function(e){if(this.options[e]){this.options[e](this)}},calculatePosition:function(e){var t=this.options.max-this.options.min;var n=this.$track.width();var r=n/t;return e*r-this.$slider.outerWidth()/2},calculateValue:function(e){var t=this.options.max-this.options.min;var n=this.$track.width();var r=t/n;var i=(e+this.$slider.outerWidth()/2)*r;i=parseFloat(i);if(i<=this.options.min){i=this.options.min}if(i>=this.options.max){i=this.options.max}return i},setPosition:function(e){var t=this.$slider.outerWidth()/2;e=Math.max(0-t,e);e=Math.min(e,this.$track.width()-t);var n=this.calculateValue(e);this.moveSliderTo(e);this.updateInputValue(n)},moveSliderTo:function(e){this.$slider.css("left",e+"px")}};t.init(this,e)})}